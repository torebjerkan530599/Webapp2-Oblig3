@model Blog.Models.ViewModels.PostViewModel

@{
    ViewData["Title"] = "Innlegg";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1>Kommenarer for innlegget "@Model.Title"</h1>
<hr />
<p>
    @*Created: @Model.Created,*@
    @if (@Model.Owner == null)
    {<a> Bruker er ikke registrert</a> }
    else
    {<a> Eier av innlegg: @Model.Owner.UserName</a>}
</p>

<!--h5>Test om jeg får tak i eier etter 'create comment' via ViewBag: @*ViewBag.Message*@</h5-->


<div>

    <table class="table table-hover">
        <tr>
            <th>Eier</th>
            <th>Kommentar</th>
            <th>Opprettet</th>
            <th>Valg</th>
        </tr>


        @try
        {
            @foreach (var item in Model.Comments)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.Owner.UserName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Text)
                    </td>

                    <td>
                        @Html.DisplayFor(modelItem => item.Created)
                    </td>

                    <td>
                        @Html.ActionLink("Edit", "EditComment", "Comment", new { CommentId = item.CommentId }) |

                        @Html.ActionLink("Delete", "DeleteComment", "Comment", new { CommentId = item.CommentId })
                    </td>
                </tr>
            }
        }
        catch (NullReferenceException e)
        {
            Console.WriteLine(e.ToString());
        }


    </table>
    <p>@Html.ActionLink("Opprett ny kommentar", "CreateComment", "Comment", new { PostId = @Model.PostId, id = @Model.PostId })</p>


</div>



<div>

    <a asp-controller="Blog" asp-action="Index">&#8592 Tilbake til alle blogger<br></a>
    <!--a asp-controller="Blog" asp-route-id=Model.BlogId asp-action="ReadBlog">&#8592 Tilbake til innlegg<br></a--> <!--Must study WebApi before this is possible-->
    <p>&#8592 @Html.ActionLink("Tilbake til innlegg", "ReadBlog", "Blog", new { id = Model.BlogId })</p>
</div>
